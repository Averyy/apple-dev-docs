# Providing one-time passcodes to AutoFill

**Framework**: Authentication Services

Help people efficiently perform multifactor authentication.

#### Overview

Many online services rely on one-time passcodes (OTPs), particularly time-based one-time passcodes (TOTP), as an additional factor when someone authenticates with the service. For example, a website might ask someone to provide their username, a password which the person knows, and a TOTP generated by the person’s authenticator app to enter the site.

Your credential provider extension can supply OTPs to AutoFill so that people can automatically fill out passcodes in apps and on websites. Someone can configure multiple credential providers in Settings so that different apps supply their passwords and OTPs in AutoFill.

##### Indicate That Your Extension Provides Otps

Open your credential provider extension’s information property list file in Xcode and add a key to the [`ASCredentialProviderExtensionCapabilities`](https://developer.apple.com/documentation/BundleResources/Information-Property-List/NSExtension/NSExtensionAttributes/ASCredentialProviderExtensionCapabilities) dictionary. Set the key’s name to `ProvidesOneTimeCodes`, and its value to the Boolean `true`.

##### Respond to System Requests for Otp Autofill

The system calls your credential provider view controller’s  [`provideCredentialWithoutUserInteraction(for:)`](ascredentialproviderviewcontroller/providecredentialwithoutuserinteraction(for:)-3mo23.md) method with a request type of [`ASCredentialRequestType.oneTimeCode`](ascredentialrequesttype/onetimecode.md) to request an OTP. If your credential provider extension can provide the code without presenting UI, call [`completeOneTimeCodeRequest(using:completionHandler:)`](ascredentialproviderextensioncontext/completeonetimecoderequest(using:completionhandler:).md) to supply the text to the system.

Otherwise, if your credential provider extension needs to present UI to provide the OTP, call [`cancelRequest(withError:)`](ascredentialproviderextensioncontext/cancelrequest(witherror:).md). Use the error domain [`ASExtensionErrorDomain`](asextensionerrordomain.md), and the code [`ASExtensionError.Code.userInteractionRequired`](asextensionerror/code/userinteractionrequired.md). The system calls [`prepareInterfaceToProvideCredential(for:)`](ascredentialproviderviewcontroller/prepareinterfacetoprovidecredential(for:)-68qpo.md). In your implementation, present the UI you need for someone to choose the OTP for the request. Call [`completeOneTimeCodeRequest(using:completionHandler:)`](ascredentialproviderextensioncontext/completeonetimecoderequest(using:completionhandler:).md) to supply the text to the system, or [`cancelRequest(withError:)`](ascredentialproviderextensioncontext/cancelrequest(witherror:).md) to inform the system if an error occurs.

##### Provide a List of Available Otps

When someone uses a text field to complete an OTP using AutoFill, they can tap a button to see a list of all available OTPs. The system calls [`prepareOneTimeCodeCredentialList(for:)`](ascredentialproviderviewcontroller/prepareonetimecodecredentiallist(for:).md) to get the list of OTPs from your extension, then presents your controller.

## See Also

- [AutoFill Credential Provider Entitlement](../BundleResources/Entitlements/com.apple.developer.authentication-services.autofill-credential-provider.md)
  A Boolean value that indicates whether the app may, with user permission, provide user names and passwords for AutoFill in Safari and other apps.
- [class ASCredentialProviderViewController](ascredentialproviderviewcontroller.md)
  A view controller that a credential manager app uses to extend AutoFill.


---

*[View on Apple Developer](https://developer.apple.com/documentation/authenticationservices/providing-one-time-passcodes-to-autofill)*