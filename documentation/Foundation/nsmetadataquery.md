# NSMetadataQuery

**Framework**: Foundation  
**Kind**: class

A query that you perform against Spotlight metadata.

**Availability**:
- iOS 5.0+
- iPadOS 5.0+
- Mac Catalyst 13.1+
- macOS 10.4+
- tvOS 9.0+
- visionOS 1.0+
- watchOS 2.0+

## Declaration

```swift
class NSMetadataQuery
```

#### Overview

The [`NSMetadataQuery`](nsmetadataquery.md) class encapsulates the functionality provided by the [`MDQuery`](https://developer.apple.com/documentation/coreservices/file_metadata/mdquery) opaque type for querying the Spotlight metadata.

[`NSMetadataQuery`](nsmetadataquery.md) objects provide metadata query results in several ways:

- As individual attribute values for requested attributes.
- As value lists that contain the distinct values for given attributes in the query results.
- As a result array proxy, containing all the query results. This is suitable for use with Cocoa bindings.
- As a hierarchical collection of results, grouping together items with the same values for specified grouping attributes. This is also suitable for use with Cocoa bindings.

Queries have two phases: the initial gathering phase that collects all currently matching results and a second live-update phase.

By default, the receiver has no limitation on its search scope. Use the [`searchScopes`](nsmetadataquery/searchscopes.md) property to customize.

By default, notification of updated results occurs at 1.0 seconds. Use the [`notificationBatchingInterval`](nsmetadataquery/notificationbatchinginterval.md) property to customize.

You must set a predicate with the [`predicate`](nsmetadataquery/predicate.md) property before starting a query.

## Topics

### Configuring Queries
- [var searchScopes: [Any]](nsmetadataquery/searchscopes.md)
  An array containing the search scopes.
- [var predicate: NSPredicate?](nsmetadataquery/predicate.md)
  The predicate used to filter query results.
- [var sortDescriptors: [NSSortDescriptor]](nsmetadataquery/sortdescriptors.md)
  An array of sort descriptor objects.
- [var valueListAttributes: [String]](nsmetadataquery/valuelistattributes.md)
  An array of attributes whose values are gathered by the query.
- [var groupingAttributes: [String]?](nsmetadataquery/groupingattributes.md)
  An array of grouping attributes. (read-only)
- [var notificationBatchingInterval: TimeInterval](nsmetadataquery/notificationbatchinginterval.md)
  The interval at which notification of updated results occurs.
- [var delegate: (any NSMetadataQueryDelegate)?](nsmetadataquery/delegate.md)
  The query’s delegate.
- [var searchItems: [Any]?](nsmetadataquery/searchitems.md)
  An array of objects that define the query’s scope.
### Running Queries
- [var isStarted: Bool](nsmetadataquery/isstarted.md)
  A Boolean value that indicates whether the query has started. (read-only)
- [func start() -> Bool](nsmetadataquery/start.md)
  Attempts to start the query.
- [var isGathering: Bool](nsmetadataquery/isgathering.md)
  A Boolean value that indicates whether the receiver is in the initial gathering phase of the query. (read-only)
- [var isStopped: Bool](nsmetadataquery/isstopped.md)
  A Boolean value that indicates whether the query has stopped.
- [func stop()](nsmetadataquery/stop.md)
  Stops the receiver’s current query from gathering any further results.
### Getting Query Results
- [var results: [Any]](nsmetadataquery/results.md)
  An array containing the query’s results.
- [var resultCount: Int](nsmetadataquery/resultcount.md)
  The number of results returned by the query. (read-only)
- [func result(at: Int) -> Any](nsmetadataquery/result(at:).md)
  Returns the query result at a specific index.
- [func index(ofResult: Any) -> Int](nsmetadataquery/index(ofresult:).md)
  Returns the index of a query result object in the receiver’s results array.
- [var groupedResults: [NSMetadataQueryResultGroup]](nsmetadataquery/groupedresults.md)
  An array containing hierarchical groups of query results. (read-only)
- [class NSMetadataQueryResultGroup](nsmetadataqueryresultgroup.md)
  The `NSMetadataQueryResultGroup` class represents a collection of grouped attribute results returned by an [`NSMetadataQuery`](nsmetadataquery.md) object.
- [func enumerateResults((Any, Int, UnsafeMutablePointer<ObjCBool>) -> Void)](nsmetadataquery/enumerateresults(_:).md)
  Enumerates the current set of results using the given block.
- [func enumerateResults(options: NSEnumerationOptions, using: (Any, Int, UnsafeMutablePointer<ObjCBool>) -> Void)](nsmetadataquery/enumerateresults(options:using:).md)
  Enumerates the current set of results using the given options and block.
- [var valueLists: [String : [NSMetadataQueryAttributeValueTuple]]](nsmetadataquery/valuelists.md)
  A dictionary containing the value lists generated by the query.
- [class NSMetadataQueryAttributeValueTuple](nsmetadataqueryattributevaluetuple.md)
  The `NSMetadataQueryAttributeValueTuple` class represents attribute-value tuples, which are objects that contain the attribute name and value of a metadata attribute.
- [func value(ofAttribute: String, forResultAt: Int) -> Any?](nsmetadataquery/value(ofattribute:forresultat:).md)
  Returns the value for the attribute name `attrName` at the index in the results specified by `idx`.
- [func enableUpdates()](nsmetadataquery/enableupdates.md)
  Enables updates to the query results.
- [func disableUpdates()](nsmetadataquery/disableupdates.md)
  Disables updates to the query results.
- [var operationQueue: OperationQueue?](nsmetadataquery/operationqueue.md)
  The queue on which query result notifications are posted.
### Constants
- [Metadata Query Search Scopes](metadata-query-search-scopes.md)
  Constants for the predefined search scopes used by [`searchScopes`](nsmetadataquery/searchscopes.md).
- [Content Relevance](content-relevance.md)
  In addition to including the requested metadata attributes, a query result also includes content relevance, accessed with the following key.
- [Keys for Use with a Notification Info Dictionary](keys-for-use-with-a-notification-info-dictionary.md)
  Constants for keys to retrieve the collection of changed items from a notification’s user info dictionary.
### Notifications
- [static let NSMetadataQueryDidFinishGathering: NSNotification.Name](nsnotification/name-swift.struct/nsmetadataquerydidfinishgathering.md)
  Posted when the receiver has finished with the initial result-gathering phase of the query.
- [static let NSMetadataQueryDidStartGathering: NSNotification.Name](nsnotification/name-swift.struct/nsmetadataquerydidstartgathering.md)
  Posted when the receiver begins with the initial result-gathering phase of the query.
- [static let NSMetadataQueryDidUpdate: NSNotification.Name](nsnotification/name-swift.struct/nsmetadataquerydidupdate.md)
  Posted when the receiver’s results have changed during the live-update phase of the query.
- [static let NSMetadataQueryGatheringProgress: NSNotification.Name](nsnotification/name-swift.struct/nsmetadataquerygatheringprogress.md)
  Posted as the receiver is collecting results during the initial result-gathering phase of the query.

## Relationships

### Inherits From
- [NSObject](../ObjectiveC/NSObject-swift.class.md)
### Conforms To
- [CVarArg](../Swift/CVarArg.md)
- [CustomDebugStringConvertible](../Swift/CustomDebugStringConvertible.md)
- [CustomStringConvertible](../Swift/CustomStringConvertible.md)
- [Equatable](../Swift/Equatable.md)
- [Hashable](../Swift/Hashable.md)
- [NSObjectProtocol](../ObjectiveC/NSObjectProtocol.md)

## See Also

- [protocol NSMetadataQueryDelegate](nsmetadataquerydelegate.md)
  An interface that enables the delegate of a metadata query to provide substitute results or attributes.
- [class NSMetadataItem](nsmetadataitem.md)
  The metadata associated with a file.


---

*[View on Apple Developer](https://developer.apple.com/documentation/foundation/nsmetadataquery)*