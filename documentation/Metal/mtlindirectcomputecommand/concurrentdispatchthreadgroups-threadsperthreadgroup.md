# concurrentDispatchThreadgroups(_:threadsPerThreadgroup:)

**Framework**: Metal  
**Kind**: method  
**Required**: Yes

Encodes a compute command using a grid aligned to threadgroup boundaries.

**Availability**:
- iOS 13.0+
- iPadOS 13.0+
- Mac Catalyst 13.1+
- macOS 11.0+
- tvOS 13.0+
- visionOS 1.0+

## Declaration

```swift
func concurrentDispatchThreadgroups(_ threadgroupsPerGrid: MTLSize, threadsPerThreadgroup: MTLSize)
```

#### Discussion

The command generated by this method is equivalent to calling [`dispatchThreadgroups(_:threadsPerThreadgroup:)`](mtlcomputecommandencoder/dispatchthreadgroups(_:threadsperthreadgroup:).md).

Compute commands encoded into an indirect command buffer donâ€™t automatically serialize access to resources with other commands in the indirect command buffer. Use barriers to serialize access to resources within a range of commands. See [`setBarrier()`](mtlindirectcomputecommand/setbarrier().md).

When you execute the commands in an indirect command buffer, the [`dispatchType`](mtlcomputecommandencoder/dispatchtype.md) property of the compute command encoder determines whether the compute command encoder adds additional barriers. If [`dispatchType`](mtlcomputecommandencoder/dispatchtype.md) is [`MTLDispatchType.serial`](mtldispatchtype/serial.md), the compute command encoder adds a barrier before and after the range of commands. If [`dispatchType`](mtlcomputecommandencoder/dispatchtype.md) is [`MTLDispatchType.concurrent`](mtldispatchtype/concurrent.md), then the compute command encoder does nothing, and you are responsible for synchronizing access to resources.

## Parameters

- `threadgroupsPerGrid`: The number of threadgroups in the grid, in each dimension.
- `threadsPerThreadgroup`: The number of threads in one threadgroup, in each dimension.

## See Also

- [func concurrentDispatchThreads(MTLSize, threadsPerThreadgroup: MTLSize)](mtlindirectcomputecommand/concurrentdispatchthreads(_:threadsperthreadgroup:).md)
  Encodes a compute command using an arbitrarily sized grid.


---

*[View on Apple Developer](https://developer.apple.com/documentation/metal/mtlindirectcomputecommand/concurrentdispatchthreadgroups(_:threadsperthreadgroup:))*